/* Add this at the very top */
:root {
    --bg-color: #f5f7fa;
    --text-color: #333333;
    --accent-color: #31708f;
}

*, *::before, ::after {
    box-sizing: border-box;
}

html {
    height: 100%;
}

body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: var(--bg-color);
    color: var(--text-color);
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
}

.game-container {
    width: 95vw;
    max-width: 1600px;
    height: 95vh;
    max-height: 1000px;
    background-color: var(--bg-color);
    color: var(--text-color);
    border-radius: 8px;
    box-shadow: 0 0 15px rgba(0,0,0,0.15);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    padding: 10px;
}

/* Info Banner */
#info-banner {
    background-color: var(--bg-color);
    border: 1px solid var(--accent-color);
    border-radius: 4px;
    padding: 8px 12px;
    margin-bottom: 10px;
    height: 60px; /* Fixed height */
    overflow-y: auto;
    font-size: 0.9em;
    line-height: 1.4;
    flex-shrink: 0; /* Prevent banner from shrinking */
    color: var(--text-color);
}
#info-banner p { margin: 0 0 4px 0; padding: 2px 0; }
.log-info { color: #31708f; }
.log-unlock { color: #3c763d; font-weight: bold; }
.log-warning { color: #a94442; font-style: italic; }
.log-upgrade { color: #666; }

/* Page Header (Now just Stats) */
#page-header {
    display: flex;
    /* REMOVED: justify-content: space-between; */
    /* Stats container will now naturally align to the left */
    align-items: center;
    padding: 0 5px 10px 5px;
    border-bottom: 1px solid var(--accent-color);
    margin-bottom: 15px;
    flex-shrink: 0;
}
/* REMOVED: #page-header h1 styling is no longer needed */

.header-stats-container {
    display: flex;
    align-items: center;
    gap: 15px; /* Space between stat items */
}
.save-load-controls {
    margin-left: auto;
    display: flex;
    gap: 10px;
}
.neuron-control {
    display: flex;
    align-items: center;
    gap: 8px;
}
#click-button { /* General styling for this button is further down */
    padding: 5px 10px;
    font-size: 0.9em;
    background-color: #555;
}
#neurons-display, #psychbucks-display, #iq-display, #ops-display, #neurofuel-display {
    font-size: 1.1em;
    font-weight: bold;
    color: var(--accent-color);
}

/* Icons for stat labels to reduce reliance on color */
#neurons-display::before { content: "üß† "; }
#psychbucks-display::before { content: "üí∞ "; }
#iq-display::before { content: "üí° "; }
#ops-display::before { content: "‚öôÔ∏è "; }
#neurofuel-display::before { content: "‚õΩ "; }


/* Main Content Wrapper (for two columns) */
.content-wrapper {
    display: flex;
    flex-direction: row; /* Side-by-side columns */
    flex-grow: 1; /* Take remaining vertical space */
    overflow: hidden; /* Important for internal scrolling of columns */
    gap: 20px; /* Space between left and right columns */
}

/* Left Column (Questions, Debug) */
.left-column {
    flex: 1.2;
    display: flex;
    flex-direction: column;
    gap: 15px;
    overflow-y: auto;
    padding: 5px;
}

#minigames-area {
    margin-top: 15px;
}

/* Right Column (Brain Viz, Upgrades) */
.right-column {
    flex: 1; 
    display: flex;
    flex-direction: column;
    gap: 15px; 
    overflow: hidden; 
}

/* Brain Visual Area (Top of Right Column) */
#brain-visual-area {
    flex-shrink: 0; 
}
.brain-viz-wrapper {
    display: flex;
    align-items: center;
    gap: 10px;
}
.brain-viz-wrapper h2 { /* Title "Your Brain" */
    margin: 0;
    font-size: 1.2em;
    color: var(--accent-color);
    flex-shrink: 0;
}
#brain-viz-home-slot {
    flex-grow: 1;
    display: flex;
}
#brain-viz-home-slot #threejs-canvas-container {
    flex-grow: 1;
}
#threejs-canvas-container {
    flex-grow: 1;
    aspect-ratio: 4 / 3;
    max-height: 160px;
    min-height: 120px;
    border: 1px solid #ccc;
    background-color: #000;
    position: relative;
}
#threejs-canvas-container canvas {
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}
#threejs-canvas-container.enlarged {
    aspect-ratio: auto;
    max-height: none;
    min-height: 0;
    height: 100%;
}

/* Lower Content in Right Column (Upgrades, Proliferation, Hypothalamus) */
.right-column-lower-content {
    flex-grow: 1; 
    overflow-y: auto; 
    display: flex;
    flex-direction: column;
    gap: 15px; 
    padding: 5px; 
}

/* General Styling for <section> elements */
section {
    background-color: #f9f9f9;
    padding: 10px;
    border-radius: 5px;
    border: 1px solid #ddd;
    flex-shrink: 0;
}

/* General H2 styling within sections */
section h2 {
    margin-top: 0;
    margin-bottom: 8px;
    color: var(--accent-color);
    font-size: 1em;
}


/* Question Area Specifics */
#question-text {
    margin-bottom: 10px;
    font-style: italic;
    line-height: 1.4;
}
#feedback-area,
#streak-feedback-area {
    margin-top: 10px;
    font-weight: bold;
    min-height: 1.2em;
}

/* Answer Options Buttons */
#answer-options button {
    display: block;
    width: 100%;
    margin-bottom: 8px;
    background-color: #6c757d; 
}
#answer-options button:hover {
    background-color: #5a6268;
}


/* Upgrade Items */
.upgrade-item {
    padding: 8px;
    border: 1px solid #eee;
    margin: 0; /* spacing handled by grid gap */
    border-radius: 4px;
    background-color: #fff;
}
.upgrade-item h3 {
    margin-top: 0;
    margin-bottom: 4px;
    font-size: 1em;
}
.upgrade-item p {
    margin: 0 0 6px 0;
    font-size: 0.85em;
    line-height: 1.2;
}
.upgrade-item button {
    font-size: 0.85em;
    padding: 4px 8px;
    background-color: #666;
}
.upgrade-item button:hover {
    background-color: #555;
}
.upgrade-item button:disabled {
    background-color: #ccc;
    cursor: not-allowed;
    opacity: 0.7;
}

/* Layout for upgrade lists */
#upgrades-list,
#neuron-proliferation-upgrades-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 10px;
}

.project-item {
    padding: 8px;
    border: 1px solid #ccd;
    margin-bottom: 8px;
    border-radius: 4px;
    background-color: #eef;
}
.project-item h3 {
    margin-top: 0;
    margin-bottom: 4px;
    font-size: 1em;
}
.project-item p {
    margin: 0 0 8px 0;
}
.project-item button {
    font-size: 0.85em;
    padding: 4px 8px;
    background-color: #666;
}
.project-item button:disabled {
    background-color: #999;
}

/* Hypothalamus Controls */
#hypothalamus-controls-area label {
    display: inline-block;
    width: 80px;
    vertical-align: middle;
}
#hypothalamus-controls-area input[type="range"] {
    width: calc(100% - 130px);
    vertical-align: middle;
    margin: 0 5px;
}
#hypothalamus-controls-area span {
    display: inline-block;
    width: 30px;
    text-align: right;
    vertical-align: middle;
    font-weight: bold;
}
#anxiety-status {
    margin-top: 10px;
    font-weight: bold;
    text-align: center;
}

/* General Button Styling (if not overridden) */
button {
    padding: 10px 15px;
    font-size: 1em;
    color: #fff;
    background-color: #666; /* Muted default */
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}
button:hover {
    background-color: #555;
}
#click-button:hover { /* Ensure #click-button specific hover is maintained */
    background-color: #444;
}


/* Scrollbar Styling */
.left-column::-webkit-scrollbar,
.right-column-lower-content::-webkit-scrollbar,
#info-banner::-webkit-scrollbar {
    width: 8px;
}
.left-column::-webkit-scrollbar-track,
.right-column-lower-content::-webkit-scrollbar-track,
#info-banner::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}
.left-column::-webkit-scrollbar-thumb,
.right-column-lower-content::-webkit-scrollbar-thumb,
#info-banner::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 4px;
}
.left-column::-webkit-scrollbar-thumb:hover,
.right-column-lower-content::-webkit-scrollbar-thumb:hover,
#info-banner::-webkit-scrollbar-thumb:hover {
    background: #aaa;
}

/* Scary Stimuli Overlay and Pop-ups */
#scary-stimuli-overlay {
    position: fixed; /* Covers the whole viewport, relative to it */
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none; /* Allows clicks to pass through the overlay itself to game elements underneath */
    z-index: 1000; /* Ensures it's on top of other game elements */
    overflow: hidden; /* In case a stimulus tries to position itself partially outside */
}

.scary-stimulus-popup {
    position: absolute; /* Positioned within the overlay */
    background-color: rgba(200, 0, 0, 0.85); /* Darker red, slightly more opaque */
    color: white;
    padding: 15px 25px;
    border: 3px solid darkred;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1.3em;
    font-weight: bold;
    text-align: center;
    box-shadow: 0 0 15px black;
    pointer-events: auto; /* Individual stimuli are clickable */
    /* You can add animations here for appearing/disappearing if you like */
    transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
    min-width: 150px; /* Ensure they have some substance */
}

.scary-stimulus-popup:hover {
    background-color: rgba(255, 0, 0, 0.95);
    transform: scale(1.05);
}

#projects-area {
    display: block;
}

/* Info Button */
#info-button {
    position: fixed;
    bottom: 15px;
    right: 15px;
    width: 40px;
    height: 40px;
    border: none;
    border-radius: 50%;
    background-color: #666;
    color: #fff;
    font-size: 20px;
    cursor: pointer;
    z-index: 1100;
}

/* Instructions Overlay */
#instructions-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.7);
    justify-content: center;
    align-items: center;
    z-index: 1200;
}

#instructions-content {
    background-color: #fff;
    padding: 20px;
    border-radius: 8px;
    max-width: 600px;
    max-height: 80vh;
    overflow-y: auto;
    text-align: left;
}

#instructions-content button {
    margin-top: 10px;
}

/* Brain Popup Overlay */
#brain-popup.popup-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0,0,0,0.7);
    justify-content: center;
    align-items: center;
    z-index: 1300;
}
#brain-popup-content {
    background-color: #fff;
    padding: 20px;
    border-radius: 12px;
    width: min(1000px, 90vw);
    height: min(90vh, 720px);
    display: flex;
    flex-direction: column;
    gap: 20px;
    position: relative;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
}
#brain-popup-content #close-brain-popup {
    position: absolute;
    top: 12px;
    right: 12px;
}
#brain-popup-visual-slot {
    flex: 1;
    min-height: 0;
    display: flex;
    align-items: stretch;
}
#brain-popup-visual-slot #threejs-canvas-container {
    flex: 1;
    border-radius: 8px;
}
#brain-popup-chart-section {
    position: absolute;
    bottom: 24px;
    right: 24px;
    width: 280px;
    height: 180px;
    padding: 12px;
    background: rgba(255, 255, 255, 0.92);
    border: 1px solid #ddd;
    border-radius: 10px;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
}
#brain-stats-chart {
    width: 100%;
    height: 100%;
}

@media (max-width: 768px) {
    #brain-popup-chart-section {
        width: min(240px, 60vw);
        height: 160px;
        bottom: 16px;
        right: 16px;
    }
}

/* NeuroSnake Popup */
#neurosnake-popup.popup-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0,0,0,0.7);
    justify-content: center;
    align-items: center;
    z-index: 1300;
}
#neurosnake-content {
    background-color: #fff;
    padding: 20px;
    border-radius: 8px;
}
#neurosnake-score {
    text-align: center;
    font-weight: bold;
    margin-bottom: 10px;
}
#neurosnake-instruction {
    text-align: center;
    margin-top: 5px;
    margin-bottom: 10px;
}
#neurosnake-canvas {
    background: #000;
    display: block;
    margin-bottom: 10px;
    width: 80vmin;
    height: 80vmin;
    max-width: 100%;
    max-height: 80vh;
}

/* Flappy Freud Popup */
#flappyfreud-popup.popup-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.72);
    justify-content: center;
    align-items: center;
    z-index: 1300;
}

#flappyfreud-content {
    background: radial-gradient(circle at top, #fef7ec 0%, #f2e4d6 48%, #d4c5b9 100%);
    padding: 20px;
    border-radius: 16px;
    width: min(92vw, 460px);
    display: flex;
    flex-direction: column;
    gap: 12px;
    box-shadow: 0 20px 40px rgba(40, 24, 7, 0.35);
    border: 3px solid rgba(99, 76, 47, 0.35);
}

.flappyfreud-topbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
}

#flappyfreud-scoreboard {
    display: flex;
    flex-direction: column;
    gap: 6px;
    font-weight: bold;
    color: #5a4029;
}

#flappyfreud-score,
#flappyfreud-best {
    background: rgba(255, 255, 255, 0.7);
    padding: 6px 12px;
    border-radius: 12px;
    box-shadow: inset 0 1px 4px rgba(255, 255, 255, 0.4);
}

#flappyfreud-canvas {
    width: 100%;
    height: auto;
    background: linear-gradient(180deg, #d2ecff 0%, #87b8e8 60%, #f5d7a3 100%);
    border-radius: 18px;
    border: 2px solid rgba(90, 64, 41, 0.3);
    box-shadow: inset 0 0 18px rgba(255, 255, 255, 0.35);
}

#flappyfreud-instructions {
    margin: 0;
    text-align: center;
    color: #3d2919;
    font-weight: 600;
}

#start-flappyfreud,
#close-flappyfreud {
    align-self: center;
    padding: 10px 22px;
    border-radius: 22px;
    border: none;
    font-weight: bold;
    cursor: pointer;
    background: linear-gradient(135deg, #8cc8ff, #5a8df2);
    color: #fff;
    box-shadow: 0 6px 14px rgba(45, 93, 184, 0.35);
    transition: transform 0.15s ease, box-shadow 0.15s ease;
}

#close-flappyfreud {
    align-self: stretch;
    max-width: 120px;
    background: linear-gradient(135deg, #d9816f, #bf4b3e);
    box-shadow: 0 6px 14px rgba(191, 75, 62, 0.35);
}

#start-flappyfreud:hover,
#start-flappyfreud:focus {
    transform: translateY(-2px);
    box-shadow: 0 10px 18px rgba(45, 93, 184, 0.4);
}

#close-flappyfreud:hover,
#close-flappyfreud:focus {
    transform: translateY(-2px);
    box-shadow: 0 10px 18px rgba(191, 75, 62, 0.4);
}

#start-flappyfreud:disabled {
    cursor: not-allowed;
    opacity: 0.6;
    transform: none;
    box-shadow: none;
}

/* Brain Tetris Popup */
#braintetris-popup.popup-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0,0,0,0.7);
    justify-content: center;
    align-items: center;
    z-index: 1300;
}

#braintetris-content {
    background: rgba(8, 10, 18, 0.96);
    padding: 24px;
    border-radius: 18px;
    width: min(92vw, 660px);
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 18px;
    box-shadow: 0 18px 46px rgba(8, 10, 18, 0.6);
    border: 2px solid rgba(75, 84, 139, 0.45);
    overflow: auto;
    color: #f0f2ff;
}

.braintetris-top {
    display: flex;
    justify-content: center;
    gap: 22px;
    align-items: flex-start;
    flex-wrap: wrap;
}

.braintetris-stats {
    display: flex;
    flex-direction: column;
    gap: 6px;
    color: #cbd3ff;
    font-weight: bold;
}

.braintetris-stats div {
    background: rgba(28, 34, 59, 0.7);
    padding: 8px 14px;
    border-radius: 12px;
    box-shadow: inset 0 1px 4px rgba(150, 164, 228, 0.35);
}

.braintetris-next {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    color: #cbd3ff;
    font-weight: bold;
}

#braintetris-next {
    background: rgba(28, 34, 59, 0.7);
    border-radius: 14px;
    padding: 10px;
    box-shadow: inset 0 1px 4px rgba(150, 164, 228, 0.35);
}

.braintetris-head {
    position: relative;
    width: min(84vw, 420px);
    aspect-ratio: 244 / 325;
    background-image: url('./images/head-silhouette.png');
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;
    border-radius: 16px;
    overflow: hidden;
    filter: drop-shadow(0 18px 32px rgba(8, 10, 18, 0.55));
}

.braintetris-brain {
    position: absolute;
    top: 12%;
    left: 29.5%;
    width: 50%;
    aspect-ratio: 1 / 2;
    display: flex;
    align-items: center;
    justify-content: center;
}

#braintetris-canvas {
    width: 100% !important;
    height: 100% !important;
    border-radius: 12px;
    background: rgba(9, 12, 21, 0.75);
    border: 2px solid rgba(203, 211, 255, 0.45);
    box-shadow: 0 0 18px rgba(82, 102, 174, 0.45);
}

.braintetris-controls {
    display: flex;
    justify-content: center;
    gap: 12px;
}

#start-braintetris,
#close-braintetris {
    padding: 8px 18px;
    border-radius: 20px;
    border: none;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.15s ease, box-shadow 0.15s ease;
}

#start-braintetris {
    background: #596bff;
    color: #fff;
    box-shadow: 0 10px 22px rgba(89, 107, 255, 0.35);
}

#close-braintetris {
    background: #2c2f47;
    color: #f0f2ff;
    box-shadow: 0 10px 22px rgba(44, 47, 71, 0.35);
}

#start-braintetris:hover,
#close-braintetris:hover {
    transform: translateY(-1px);
    box-shadow: 0 12px 26px rgba(82, 102, 174, 0.35);
}

#braintetris-message {
    margin: 0;
    text-align: center;
    color: rgba(203, 211, 255, 0.85);
    font-weight: 600;
}

@media (max-width: 640px) {
    .braintetris-brain {
        top: 14%;
        left: 27%;
        width: 56%;
        aspect-ratio: 1 / 2;
    }
}



/* Upgrade Animation Overlay */
#upgrade-animation-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    overflow: visible;
    z-index: 1400;
}

body.brain-popup-open {
    overflow: hidden;
}

#upgrade-animation-overlay .upgrade-spin-image {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%) scale(0.5);
    width: 300px;
    height: auto;
    transform-origin: center;
    animation: upgrade-spin-fade 2s ease-out forwards;
}

@keyframes upgrade-spin-fade {
    0% {
        transform: translate(-50%, -50%) scale(0.5) rotate(0deg);
        opacity: 1;
    }
    80% {
        transform: translate(-50%, -50%) scale(3) rotate(720deg);
        opacity: 1;
    }
    100% {
        transform: translate(-50%, -50%) scale(3) rotate(720deg);
        opacity: 0;
    }
}

#upgrade-animation-overlay .upgrade-particle {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 8px;
    height: 8px;
    background-color: gold;
    border-radius: 50%;
    opacity: 1;
    transform: translate(0, 0) scale(1);
    transition: transform 1s ease-out, opacity 1s ease-out;
}
